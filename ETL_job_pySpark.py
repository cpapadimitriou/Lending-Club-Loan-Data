import sys
from awsglue.transforms import *
from awsglue.utils import getResolvedOptions
from pyspark.context import SparkContext
from awsglue.context import GlueContext
from awsglue.job import Job

## @params: [JOB_NAME]
args = getResolvedOptions(sys.argv, ['JOB_NAME'])

sc = SparkContext()
glueContext = GlueContext(sc)
spark = glueContext.spark_session
job = Job(glueContext)
job.init(args['JOB_NAME'], args)
## @type: DataSource
## @args: [database = "loandata", table_name = "lending_club_load_data", transformation_ctx = "datasource0"]
## @return: datasource0
## @inputs: []
datasource0 = glueContext.create_dynamic_frame.from_catalog(database = "loandata", table_name = "lending_club_load_data", transformation_ctx = "datasource0")
## @type: ApplyMapping
## @args: [mapping = [("id", "string", "id", "string"), ("member_id", "string", "member_id", "string"), ("loan_amnt", "long", "loan_amnt", "long"), ("funded_amnt", "long", "funded_amnt", "long"), ("funded_amnt_inv", "long", "funded_amnt_inv", "long"), ("term", "string", "term", "string"), ("int_rate", "double", "int_rate", "double"), ("installment", "double", "installment", "double"), ("grade", "string", "grade", "string"), ("sub_grade", "string", "sub_grade", "string"), ("emp_title", "string", "emp_title", "string"), ("emp_length", "string", "emp_length", "string"), ("home_ownership", "string", "home_ownership", "string"), ("annual_inc", "long", "annual_inc", "long"), ("verification_status", "string", "verification_status", "string"), ("issue_d", "string", "issue_d", "string"), ("loan_status", "string", "loan_status", "string"), ("pymnt_plan", "string", "pymnt_plan", "string"), ("url", "string", "url", "string"), ("desc", "string", "desc", "string"), ("purpose", "string", "purpose", "string"), ("title", "string", "title", "string"), ("zip_code", "string", "zip_code", "string"), ("addr_state", "string", "addr_state", "string"), ("dti", "double", "dti", "double"), ("delinq_2yrs", "long", "delinq_2yrs", "long"), ("earliest_cr_line", "string", "earliest_cr_line", "string"), ("inq_last_6mths", "long", "inq_last_6mths", "long"), ("mths_since_last_delinq", "long", "mths_since_last_delinq", "long"), ("mths_since_last_record", "long", "mths_since_last_record", "long"), ("open_acc", "long", "open_acc", "long"), ("pub_rec", "long", "pub_rec", "long"), ("revol_bal", "long", "revol_bal", "long"), ("revol_util", "double", "revol_util", "double"), ("total_acc", "long", "total_acc", "long"), ("initial_list_status", "string", "initial_list_status", "string"), ("out_prncp", "double", "out_prncp", "double"), ("out_prncp_inv", "double", "out_prncp_inv", "double"), ("total_pymnt", "double", "total_pymnt", "double"), ("total_pymnt_inv", "double", "total_pymnt_inv", "double"), ("total_rec_prncp", "double", "total_rec_prncp", "double"), ("total_rec_int", "double", "total_rec_int", "double"), ("total_rec_late_fee", "double", "total_rec_late_fee", "double"), ("recoveries", "double", "recoveries", "double"), ("collection_recovery_fee", "double", "collection_recovery_fee", "double"), ("last_pymnt_d", "string", "last_pymnt_d", "string"), ("last_pymnt_amnt", "double", "last_pymnt_amnt", "double"), ("next_pymnt_d", "string", "next_pymnt_d", "string"), ("last_credit_pull_d", "string", "last_credit_pull_d", "string"), ("collections_12_mths_ex_med", "long", "collections_12_mths_ex_med", "long"), ("mths_since_last_major_derog", "long", "mths_since_last_major_derog", "long"), ("policy_code", "long", "policy_code", "long"), ("application_type", "string", "application_type", "string"), ("annual_inc_joint", "long", "annual_inc_joint", "long"), ("dti_joint", "double", "dti_joint", "double"), ("verification_status_joint", "string", "verification_status_joint", "string"), ("acc_now_delinq", "long", "acc_now_delinq", "long"), ("tot_coll_amt", "long", "tot_coll_amt", "long"), ("tot_cur_bal", "long", "tot_cur_bal", "long"), ("open_acc_6m", "long", "open_acc_6m", "long"), ("open_act_il", "long", "open_act_il", "long"), ("open_il_12m", "long", "open_il_12m", "long"), ("open_il_24m", "long", "open_il_24m", "long"), ("mths_since_rcnt_il", "long", "mths_since_rcnt_il", "long"), ("total_bal_il", "long", "total_bal_il", "long"), ("il_util", "long", "il_util", "long"), ("open_rv_12m", "long", "open_rv_12m", "long"), ("open_rv_24m", "long", "open_rv_24m", "long"), ("max_bal_bc", "long", "max_bal_bc", "long"), ("all_util", "long", "all_util", "long"), ("total_rev_hi_lim", "long", "total_rev_hi_lim", "long"), ("inq_fi", "long", "inq_fi", "long"), ("total_cu_tl", "long", "total_cu_tl", "long"), ("inq_last_12m", "long", "inq_last_12m", "long"), ("acc_open_past_24mths", "long", "acc_open_past_24mths", "long"), ("avg_cur_bal", "long", "avg_cur_bal", "long"), ("bc_open_to_buy", "long", "bc_open_to_buy", "long"), ("bc_util", "double", "bc_util", "double"), ("chargeoff_within_12_mths", "long", "chargeoff_within_12_mths", "long"), ("delinq_amnt", "long", "delinq_amnt", "long"), ("mo_sin_old_il_acct", "long", "mo_sin_old_il_acct", "long"), ("mo_sin_old_rev_tl_op", "long", "mo_sin_old_rev_tl_op", "long"), ("mo_sin_rcnt_rev_tl_op", "long", "mo_sin_rcnt_rev_tl_op", "long"), ("mo_sin_rcnt_tl", "long", "mo_sin_rcnt_tl", "long"), ("mort_acc", "long", "mort_acc", "long"), ("mths_since_recent_bc", "long", "mths_since_recent_bc", "long"), ("mths_since_recent_bc_dlq", "long", "mths_since_recent_bc_dlq", "long"), ("mths_since_recent_inq", "long", "mths_since_recent_inq", "long"), ("mths_since_recent_revol_delinq", "long", "mths_since_recent_revol_delinq", "long"), ("num_accts_ever_120_pd", "long", "num_accts_ever_120_pd", "long"), ("num_actv_bc_tl", "long", "num_actv_bc_tl", "long"), ("num_actv_rev_tl", "long", "num_actv_rev_tl", "long"), ("num_bc_sats", "long", "num_bc_sats", "long"), ("num_bc_tl", "long", "num_bc_tl", "long"), ("num_il_tl", "long", "num_il_tl", "long"), ("num_op_rev_tl", "long", "num_op_rev_tl", "long"), ("num_rev_accts", "long", "num_rev_accts", "long"), ("num_rev_tl_bal_gt_0", "long", "num_rev_tl_bal_gt_0", "long"), ("num_sats", "long", "num_sats", "long"), ("num_tl_120dpd_2m", "long", "num_tl_120dpd_2m", "long"), ("num_tl_30dpd", "long", "num_tl_30dpd", "long"), ("num_tl_90g_dpd_24m", "long", "num_tl_90g_dpd_24m", "long"), ("num_tl_op_past_12m", "long", "num_tl_op_past_12m", "long"), ("pct_tl_nvr_dlq", "double", "pct_tl_nvr_dlq", "double"), ("percent_bc_gt_75", "double", "percent_bc_gt_75", "double"), ("pub_rec_bankruptcies", "long", "pub_rec_bankruptcies", "long"), ("tax_liens", "long", "tax_liens", "long"), ("tot_hi_cred_lim", "long", "tot_hi_cred_lim", "long"), ("total_bal_ex_mort", "long", "total_bal_ex_mort", "long"), ("total_bc_limit", "long", "total_bc_limit", "long"), ("total_il_high_credit_limit", "long", "total_il_high_credit_limit", "long"), ("revol_bal_joint", "long", "revol_bal_joint", "long"), ("sec_app_earliest_cr_line", "string", "sec_app_earliest_cr_line", "string"), ("sec_app_inq_last_6mths", "long", "sec_app_inq_last_6mths", "long"), ("sec_app_mort_acc", "long", "sec_app_mort_acc", "long"), ("sec_app_open_acc", "long", "sec_app_open_acc", "long"), ("sec_app_revol_util", "double", "sec_app_revol_util", "double"), ("sec_app_open_act_il", "long", "sec_app_open_act_il", "long"), ("sec_app_num_rev_accts", "long", "sec_app_num_rev_accts", "long"), ("sec_app_chargeoff_within_12_mths", "long", "sec_app_chargeoff_within_12_mths", "long"), ("sec_app_collections_12_mths_ex_med", "long", "sec_app_collections_12_mths_ex_med", "long"), ("sec_app_mths_since_last_major_derog", "long", "sec_app_mths_since_last_major_derog", "long"), ("hardship_flag", "string", "hardship_flag", "string"), ("hardship_type", "string", "hardship_type", "string"), ("hardship_reason", "string", "hardship_reason", "string"), ("hardship_status", "string", "hardship_status", "string"), ("deferral_term", "string", "deferral_term", "string"), ("hardship_amount", "string", "hardship_amount", "string"), ("hardship_start_date", "string", "hardship_start_date", "string"), ("hardship_end_date", "string", "hardship_end_date", "string"), ("payment_plan_start_date", "string", "payment_plan_start_date", "string"), ("hardship_length", "string", "hardship_length", "string"), ("hardship_dpd", "string", "hardship_dpd", "string"), ("hardship_loan_status", "string", "hardship_loan_status", "string"), ("orig_projected_additional_accrued_interest", "string", "orig_projected_additional_accrued_interest", "string"), ("hardship_payoff_balance_amount", "string", "hardship_payoff_balance_amount", "string"), ("hardship_last_payment_amount", "string", "hardship_last_payment_amount", "string"), ("disbursement_method", "string", "disbursement_method", "string"), ("debt_settlement_flag", "string", "debt_settlement_flag", "string"), ("debt_settlement_flag_date", "string", "debt_settlement_flag_date", "string"), ("settlement_status", "string", "settlement_status", "string"), ("settlement_date", "string", "settlement_date", "string"), ("settlement_amount", "string", "settlement_amount", "string"), ("settlement_percentage", "string", "settlement_percentage", "string"), ("settlement_term", "string", "settlement_term", "string")], transformation_ctx = "applymapping1"]
## @return: applymapping1
## @inputs: [frame = datasource0]
applymapping1 = ApplyMapping.apply(frame = datasource0, mappings = [("id", "string", "id", "string"), ("member_id", "string", "member_id", "string"), ("loan_amnt", "long", "loan_amnt", "long"), ("funded_amnt", "long", "funded_amnt", "long"), ("funded_amnt_inv", "long", "funded_amnt_inv", "long"), ("term", "string", "term", "string"), ("int_rate", "double", "int_rate", "double"), ("installment", "double", "installment", "double"), ("grade", "string", "grade", "string"), ("sub_grade", "string", "sub_grade", "string"), ("emp_title", "string", "emp_title", "string"), ("emp_length", "string", "emp_length", "string"), ("home_ownership", "string", "home_ownership", "string"), ("annual_inc", "long", "annual_inc", "long"), ("verification_status", "string", "verification_status", "string"), ("issue_d", "string", "issue_d", "string"), ("loan_status", "string", "loan_status", "string"), ("pymnt_plan", "string", "pymnt_plan", "string"), ("url", "string", "url", "string"), ("desc", "string", "desc", "string"), ("purpose", "string", "purpose", "string"), ("title", "string", "title", "string"), ("zip_code", "string", "zip_code", "string"), ("addr_state", "string", "addr_state", "string"), ("dti", "double", "dti", "double"), ("delinq_2yrs", "long", "delinq_2yrs", "long"), ("earliest_cr_line", "string", "earliest_cr_line", "string"), ("inq_last_6mths", "long", "inq_last_6mths", "long"), ("mths_since_last_delinq", "long", "mths_since_last_delinq", "long"), ("mths_since_last_record", "long", "mths_since_last_record", "long"), ("open_acc", "long", "open_acc", "long"), ("pub_rec", "long", "pub_rec", "long"), ("revol_bal", "long", "revol_bal", "long"), ("revol_util", "double", "revol_util", "double"), ("total_acc", "long", "total_acc", "long"), ("initial_list_status", "string", "initial_list_status", "string"), ("out_prncp", "double", "out_prncp", "double"), ("out_prncp_inv", "double", "out_prncp_inv", "double"), ("total_pymnt", "double", "total_pymnt", "double"), ("total_pymnt_inv", "double", "total_pymnt_inv", "double"), ("total_rec_prncp", "double", "total_rec_prncp", "double"), ("total_rec_int", "double", "total_rec_int", "double"), ("total_rec_late_fee", "double", "total_rec_late_fee", "double"), ("recoveries", "double", "recoveries", "double"), ("collection_recovery_fee", "double", "collection_recovery_fee", "double"), ("last_pymnt_d", "string", "last_pymnt_d", "string"), ("last_pymnt_amnt", "double", "last_pymnt_amnt", "double"), ("next_pymnt_d", "string", "next_pymnt_d", "string"), ("last_credit_pull_d", "string", "last_credit_pull_d", "string"), ("collections_12_mths_ex_med", "long", "collections_12_mths_ex_med", "long"), ("mths_since_last_major_derog", "long", "mths_since_last_major_derog", "long"), ("policy_code", "long", "policy_code", "long"), ("application_type", "string", "application_type", "string"), ("annual_inc_joint", "long", "annual_inc_joint", "long"), ("dti_joint", "double", "dti_joint", "double"), ("verification_status_joint", "string", "verification_status_joint", "string"), ("acc_now_delinq", "long", "acc_now_delinq", "long"), ("tot_coll_amt", "long", "tot_coll_amt", "long"), ("tot_cur_bal", "long", "tot_cur_bal", "long"), ("open_acc_6m", "long", "open_acc_6m", "long"), ("open_act_il", "long", "open_act_il", "long"), ("open_il_12m", "long", "open_il_12m", "long"), ("open_il_24m", "long", "open_il_24m", "long"), ("mths_since_rcnt_il", "long", "mths_since_rcnt_il", "long"), ("total_bal_il", "long", "total_bal_il", "long"), ("il_util", "long", "il_util", "long"), ("open_rv_12m", "long", "open_rv_12m", "long"), ("open_rv_24m", "long", "open_rv_24m", "long"), ("max_bal_bc", "long", "max_bal_bc", "long"), ("all_util", "long", "all_util", "long"), ("total_rev_hi_lim", "long", "total_rev_hi_lim", "long"), ("inq_fi", "long", "inq_fi", "long"), ("total_cu_tl", "long", "total_cu_tl", "long"), ("inq_last_12m", "long", "inq_last_12m", "long"), ("acc_open_past_24mths", "long", "acc_open_past_24mths", "long"), ("avg_cur_bal", "long", "avg_cur_bal", "long"), ("bc_open_to_buy", "long", "bc_open_to_buy", "long"), ("bc_util", "double", "bc_util", "double"), ("chargeoff_within_12_mths", "long", "chargeoff_within_12_mths", "long"), ("delinq_amnt", "long", "delinq_amnt", "long"), ("mo_sin_old_il_acct", "long", "mo_sin_old_il_acct", "long"), ("mo_sin_old_rev_tl_op", "long", "mo_sin_old_rev_tl_op", "long"), ("mo_sin_rcnt_rev_tl_op", "long", "mo_sin_rcnt_rev_tl_op", "long"), ("mo_sin_rcnt_tl", "long", "mo_sin_rcnt_tl", "long"), ("mort_acc", "long", "mort_acc", "long"), ("mths_since_recent_bc", "long", "mths_since_recent_bc", "long"), ("mths_since_recent_bc_dlq", "long", "mths_since_recent_bc_dlq", "long"), ("mths_since_recent_inq", "long", "mths_since_recent_inq", "long"), ("mths_since_recent_revol_delinq", "long", "mths_since_recent_revol_delinq", "long"), ("num_accts_ever_120_pd", "long", "num_accts_ever_120_pd", "long"), ("num_actv_bc_tl", "long", "num_actv_bc_tl", "long"), ("num_actv_rev_tl", "long", "num_actv_rev_tl", "long"), ("num_bc_sats", "long", "num_bc_sats", "long"), ("num_bc_tl", "long", "num_bc_tl", "long"), ("num_il_tl", "long", "num_il_tl", "long"), ("num_op_rev_tl", "long", "num_op_rev_tl", "long"), ("num_rev_accts", "long", "num_rev_accts", "long"), ("num_rev_tl_bal_gt_0", "long", "num_rev_tl_bal_gt_0", "long"), ("num_sats", "long", "num_sats", "long"), ("num_tl_120dpd_2m", "long", "num_tl_120dpd_2m", "long"), ("num_tl_30dpd", "long", "num_tl_30dpd", "long"), ("num_tl_90g_dpd_24m", "long", "num_tl_90g_dpd_24m", "long"), ("num_tl_op_past_12m", "long", "num_tl_op_past_12m", "long"), ("pct_tl_nvr_dlq", "double", "pct_tl_nvr_dlq", "double"), ("percent_bc_gt_75", "double", "percent_bc_gt_75", "double"), ("pub_rec_bankruptcies", "long", "pub_rec_bankruptcies", "long"), ("tax_liens", "long", "tax_liens", "long"), ("tot_hi_cred_lim", "long", "tot_hi_cred_lim", "long"), ("total_bal_ex_mort", "long", "total_bal_ex_mort", "long"), ("total_bc_limit", "long", "total_bc_limit", "long"), ("total_il_high_credit_limit", "long", "total_il_high_credit_limit", "long"), ("revol_bal_joint", "long", "revol_bal_joint", "long"), ("sec_app_earliest_cr_line", "string", "sec_app_earliest_cr_line", "string"), ("sec_app_inq_last_6mths", "long", "sec_app_inq_last_6mths", "long"), ("sec_app_mort_acc", "long", "sec_app_mort_acc", "long"), ("sec_app_open_acc", "long", "sec_app_open_acc", "long"), ("sec_app_revol_util", "double", "sec_app_revol_util", "double"), ("sec_app_open_act_il", "long", "sec_app_open_act_il", "long"), ("sec_app_num_rev_accts", "long", "sec_app_num_rev_accts", "long"), ("sec_app_chargeoff_within_12_mths", "long", "sec_app_chargeoff_within_12_mths", "long"), ("sec_app_collections_12_mths_ex_med", "long", "sec_app_collections_12_mths_ex_med", "long"), ("sec_app_mths_since_last_major_derog", "long", "sec_app_mths_since_last_major_derog", "long"), ("hardship_flag", "string", "hardship_flag", "string"), ("hardship_type", "string", "hardship_type", "string"), ("hardship_reason", "string", "hardship_reason", "string"), ("hardship_status", "string", "hardship_status", "string"), ("deferral_term", "string", "deferral_term", "string"), ("hardship_amount", "string", "hardship_amount", "string"), ("hardship_start_date", "string", "hardship_start_date", "string"), ("hardship_end_date", "string", "hardship_end_date", "string"), ("payment_plan_start_date", "string", "payment_plan_start_date", "string"), ("hardship_length", "string", "hardship_length", "string"), ("hardship_dpd", "string", "hardship_dpd", "string"), ("hardship_loan_status", "string", "hardship_loan_status", "string"), ("orig_projected_additional_accrued_interest", "string", "orig_projected_additional_accrued_interest", "string"), ("hardship_payoff_balance_amount", "string", "hardship_payoff_balance_amount", "string"), ("hardship_last_payment_amount", "string", "hardship_last_payment_amount", "string"), ("disbursement_method", "string", "disbursement_method", "string"), ("debt_settlement_flag", "string", "debt_settlement_flag", "string"), ("debt_settlement_flag_date", "string", "debt_settlement_flag_date", "string"), ("settlement_status", "string", "settlement_status", "string"), ("settlement_date", "string", "settlement_date", "string"), ("settlement_amount", "string", "settlement_amount", "string"), ("settlement_percentage", "string", "settlement_percentage", "string"), ("settlement_term", "string", "settlement_term", "string")], transformation_ctx = "applymapping1")
## @type: SelectFields
## @args: [paths = ["id", "member_id", "loan_amnt", "funded_amnt", "funded_amnt_inv", "term", "int_rate", "installment", "grade", "sub_grade", "emp_title", "emp_length", "home_ownership", "annual_inc", "verification_status", "issue_d", "loan_status", "pymnt_plan", "url", "desc", "purpose", "title", "zip_code", "addr_state", "dti", "delinq_2yrs", "earliest_cr_line", "inq_last_6mths", "mths_since_last_delinq", "mths_since_last_record", "open_acc", "pub_rec", "revol_bal", "revol_util", "total_acc", "initial_list_status", "out_prncp", "out_prncp_inv", "total_pymnt", "total_pymnt_inv", "total_rec_prncp", "total_rec_int", "total_rec_late_fee", "recoveries", "collection_recovery_fee", "last_pymnt_d", "last_pymnt_amnt", "next_pymnt_d", "last_credit_pull_d", "collections_12_mths_ex_med", "mths_since_last_major_derog", "policy_code", "application_type", "annual_inc_joint", "dti_joint", "verification_status_joint", "acc_now_delinq", "tot_coll_amt", "tot_cur_bal", "open_acc_6m", "open_act_il", "open_il_12m", "open_il_24m", "mths_since_rcnt_il", "total_bal_il", "il_util", "open_rv_12m", "open_rv_24m", "max_bal_bc", "all_util", "total_rev_hi_lim", "inq_fi", "total_cu_tl", "inq_last_12m", "acc_open_past_24mths", "avg_cur_bal", "bc_open_to_buy", "bc_util", "chargeoff_within_12_mths", "delinq_amnt", "mo_sin_old_il_acct", "mo_sin_old_rev_tl_op", "mo_sin_rcnt_rev_tl_op", "mo_sin_rcnt_tl", "mort_acc", "mths_since_recent_bc", "mths_since_recent_bc_dlq", "mths_since_recent_inq", "mths_since_recent_revol_delinq", "num_accts_ever_120_pd", "num_actv_bc_tl", "num_actv_rev_tl", "num_bc_sats", "num_bc_tl", "num_il_tl", "num_op_rev_tl", "num_rev_accts", "num_rev_tl_bal_gt_0", "num_sats", "num_tl_120dpd_2m", "num_tl_30dpd", "num_tl_90g_dpd_24m", "num_tl_op_past_12m", "pct_tl_nvr_dlq", "percent_bc_gt_75", "pub_rec_bankruptcies", "tax_liens", "tot_hi_cred_lim", "total_bal_ex_mort", "total_bc_limit", "total_il_high_credit_limit", "revol_bal_joint", "sec_app_earliest_cr_line", "sec_app_inq_last_6mths", "sec_app_mort_acc", "sec_app_open_acc", "sec_app_revol_util", "sec_app_open_act_il", "sec_app_num_rev_accts", "sec_app_chargeoff_within_12_mths", "sec_app_collections_12_mths_ex_med", "sec_app_mths_since_last_major_derog", "hardship_flag", "hardship_type", "hardship_reason", "hardship_status", "deferral_term", "hardship_amount", "hardship_start_date", "hardship_end_date", "payment_plan_start_date", "hardship_length", "hardship_dpd", "hardship_loan_status", "orig_projected_additional_accrued_interest", "hardship_payoff_balance_amount", "hardship_last_payment_amount", "disbursement_method", "debt_settlement_flag", "debt_settlement_flag_date", "settlement_status", "settlement_date", "settlement_amount", "settlement_percentage", "settlement_term"], transformation_ctx = "selectfields2"]
## @return: selectfields2
## @inputs: [frame = applymapping1]
selectfields2 = SelectFields.apply(frame = applymapping1, paths = ["id", "member_id", "loan_amnt", "funded_amnt", "funded_amnt_inv", "term", "int_rate", "installment", "grade", "sub_grade", "emp_title", "emp_length", "home_ownership", "annual_inc", "verification_status", "issue_d", "loan_status", "pymnt_plan", "url", "desc", "purpose", "title", "zip_code", "addr_state", "dti", "delinq_2yrs", "earliest_cr_line", "inq_last_6mths", "mths_since_last_delinq", "mths_since_last_record", "open_acc", "pub_rec", "revol_bal", "revol_util", "total_acc", "initial_list_status", "out_prncp", "out_prncp_inv", "total_pymnt", "total_pymnt_inv", "total_rec_prncp", "total_rec_int", "total_rec_late_fee", "recoveries", "collection_recovery_fee", "last_pymnt_d", "last_pymnt_amnt", "next_pymnt_d", "last_credit_pull_d", "collections_12_mths_ex_med", "mths_since_last_major_derog", "policy_code", "application_type", "annual_inc_joint", "dti_joint", "verification_status_joint", "acc_now_delinq", "tot_coll_amt", "tot_cur_bal", "open_acc_6m", "open_act_il", "open_il_12m", "open_il_24m", "mths_since_rcnt_il", "total_bal_il", "il_util", "open_rv_12m", "open_rv_24m", "max_bal_bc", "all_util", "total_rev_hi_lim", "inq_fi", "total_cu_tl", "inq_last_12m", "acc_open_past_24mths", "avg_cur_bal", "bc_open_to_buy", "bc_util", "chargeoff_within_12_mths", "delinq_amnt", "mo_sin_old_il_acct", "mo_sin_old_rev_tl_op", "mo_sin_rcnt_rev_tl_op", "mo_sin_rcnt_tl", "mort_acc", "mths_since_recent_bc", "mths_since_recent_bc_dlq", "mths_since_recent_inq", "mths_since_recent_revol_delinq", "num_accts_ever_120_pd", "num_actv_bc_tl", "num_actv_rev_tl", "num_bc_sats", "num_bc_tl", "num_il_tl", "num_op_rev_tl", "num_rev_accts", "num_rev_tl_bal_gt_0", "num_sats", "num_tl_120dpd_2m", "num_tl_30dpd", "num_tl_90g_dpd_24m", "num_tl_op_past_12m", "pct_tl_nvr_dlq", "percent_bc_gt_75", "pub_rec_bankruptcies", "tax_liens", "tot_hi_cred_lim", "total_bal_ex_mort", "total_bc_limit", "total_il_high_credit_limit", "revol_bal_joint", "sec_app_earliest_cr_line", "sec_app_inq_last_6mths", "sec_app_mort_acc", "sec_app_open_acc", "sec_app_revol_util", "sec_app_open_act_il", "sec_app_num_rev_accts", "sec_app_chargeoff_within_12_mths", "sec_app_collections_12_mths_ex_med", "sec_app_mths_since_last_major_derog", "hardship_flag", "hardship_type", "hardship_reason", "hardship_status", "deferral_term", "hardship_amount", "hardship_start_date", "hardship_end_date", "payment_plan_start_date", "hardship_length", "hardship_dpd", "hardship_loan_status", "orig_projected_additional_accrued_interest", "hardship_payoff_balance_amount", "hardship_last_payment_amount", "disbursement_method", "debt_settlement_flag", "debt_settlement_flag_date", "settlement_status", "settlement_date", "settlement_amount", "settlement_percentage", "settlement_term"], transformation_ctx = "selectfields2")
## @type: ResolveChoice
## @args: [choice = "MATCH_CATALOG", database = "loandata", table_name = "lending_club_load_data", transformation_ctx = "resolvechoice3"]
## @return: resolvechoice3
## @inputs: [frame = selectfields2]
resolvechoice3 = ResolveChoice.apply(frame = selectfields2, choice = "MATCH_CATALOG", database = "loandata", table_name = "lending_club_load_data", transformation_ctx = "resolvechoice3")
## @type: DataSink
## @args: [database = "loandata", table_name = "lending_club_load_data", transformation_ctx = "datasink4"]
## @return: datasink4
## @inputs: [frame = resolvechoice3]
datasink4 = glueContext.write_dynamic_frame.from_catalog(frame = resolvechoice3, database = "loandata", table_name = "lending_club_load_data", transformation_ctx = "datasink4")
job.commit()